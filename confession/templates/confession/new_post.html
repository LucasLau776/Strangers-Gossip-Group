{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>New Post - MMU Strangers Gossip</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body class="{% if request.COOKIES.theme == 'dark' %}dark-mode{% endif %}">

  <!-- 实体导航 -->
  <div class="top-nav">
    <div class="logo">
      <a href="{% url 'index' %}">
        <span style="color:#005BAC;">M</span><span style="color:#005BAC;">M</span><span style="color:#ED1C24;">U</span> Strangers Gossip
      </a>
    </div>
    <form method="GET" action="{% url 'search' %}" class="search-container">
      <input type="text" name="q" placeholder="Search..." required>
    </form>
    <div class="nav-links">
      <a href="{% url 'index' %}">Home</a>
      <a href="{% url 'trending' %}">Trending</a>
      <a href="{% url 'post_confession' %}">Post</a>
      {% if user.is_authenticated %}
        <a href="{% url 'logout' %}">Logout</a>
      {% else %}
        <a href="{% url 'login' %}">Login</a>
        <a href="{% url 'register' %}">Register</a>
      {% endif %}
    </div>
  </div>

  <!-- 模块导航 -->
  {% include 'confession/navbar.html' %}

  <div class="container" style="margin: 100px auto 60px; max-width: 700px; padding: 0 20px;">
    <h2 class="mb-3">Create a New Post</h2>

    {% if not user.is_authenticated %}
      <div class="alert alert-warning text-center">
        You must <a href="{% url 'login' %}?next={{ request.path }}">login</a> to post.
      </div>
    {% else %}
      <form id="new-post-form" method="POST" action="{% url 'post_confession' %}" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="mb-3">
          <label for="title" class="form-label">Title</label>
          <input type="text" name="title" id="title" class="form-control" required>
        </div>

        <div class="mb-3">
          <label for="content" class="form-label">Post Content</label>
          <textarea name="content" id="content" class="form-control" rows="5" required></textarea>
        </div>

        <div class="mb-3">
          <label for="image" class="form-label">Upload Image or GIF (optional)</label>
          <input type="file" name="image" id="image" class="form-control" accept="image/*,image/gif">
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-primary">Submit Post</button>
        </div>
      </form>
    {% endif %}
  </div>

  {% include 'confession/floating_buttons.html' %}
  {% include 'confession/footer.html' %}
</body>
</html>
